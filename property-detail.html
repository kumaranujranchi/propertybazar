<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Luxurious 3 BHK Flat in Sector 62 Noida | PropertyBazaar</title>
  <meta name="description" content="3 BHK apartment for sale at â‚¹85 Lakh in Sector 62, Noida. 1450 sq.ft, ready to move, swimming pool, gym, 24x7 security. RERA registered.">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/responsive.css">
  <link rel="stylesheet" href="css/city-dropdown.css">
  <style>
    /* ---- Gallery skeleton shimmer ---- */
    .gallery-skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: shimmer 1.4s infinite;
    }
    @keyframes shimmer { 0%{background-position:200% 0} 100%{background-position:-200% 0} }
    .gallery-main img, .gallery-thumb img { transition: opacity 0.4s ease; }

    /* ---- Clickable gallery ---- */
    .gallery-main, .gallery-thumb { cursor: zoom-in; }

    /* ---- Lightbox ---- */
    #photolightbox {
      display: none; position: fixed; inset: 0; z-index: 9999;
      background: rgba(0,0,0,0.95); flex-direction: column;
      align-items: center; justify-content: center;
    }
    #photolightbox.open { display: flex; animation: lbFade 0.2s ease; }
    @keyframes lbFade { from { opacity:0 } to { opacity:1 } }
    #lbClose {
      position: absolute; top: 16px; right: 20px; font-size: 32px; color: #fff;
      cursor: pointer; opacity: 0.7; transition: opacity 0.2s; z-index: 10;
      background: none; border: none; line-height: 1;
    }
    #lbClose:hover { opacity: 1; }
    #lbCounter {
      position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
      color: rgba(255,255,255,0.7); font-size: 13px; font-weight: 600; letter-spacing: 1px;
    }
    #lbMainImg {
      max-width: 90vw; max-height: 80vh; object-fit: contain;
      border-radius: 4px; transition: opacity 0.25s;
    }
    #lbPrev, #lbNext {
      position: absolute; top: 50%; transform: translateY(-50%);
      background: rgba(255,255,255,0.12); border: none; color: #fff;
      font-size: 28px; width: 52px; height: 52px; border-radius: 50%;
      cursor: pointer; display: flex; align-items: center; justify-content: center;
      transition: background 0.2s; z-index: 10;
    }
    #lbPrev { left: 12px; } #lbNext { right: 12px; }
    #lbPrev:hover, #lbNext:hover { background: rgba(255,255,255,0.25); }
    #lbThumbs {
      display: flex; gap: 8px; margin-top: 16px; overflow-x: auto;
      max-width: 90vw; padding: 4px; scrollbar-width: thin;
    }
    .lb-thumb {
      width: 60px; height: 46px; object-fit: cover; border-radius: 4px;
      cursor: pointer; opacity: 0.5; transition: opacity 0.2s; flex-shrink: 0;
      border: 2px solid transparent;
    }
    .lb-thumb.active { opacity: 1; border-color: var(--primary, #e84b1e); }
    .lb-thumb:hover { opacity: 0.85; }
  </style>

</head>
<body>
<!-- PHOTO LIGHTBOX MODAL -->
<div id="photolightbox" role="dialog" aria-modal="true" aria-label="Photo viewer">
  <button id="lbClose" aria-label="Close">âœ•</button>
  <div id="lbCounter">1 / 1</div>
  <button id="lbPrev" aria-label="Previous photo">â€¹</button>
  <img id="lbMainImg" src="" alt="Property photo">
  <button id="lbNext" aria-label="Next photo">â€º</button>
  <div id="lbThumbs"></div>
</div>

<!-- HEADER -->

<header class="header" id="header">
  <div class="container">
    <nav class="nav">
      <a href="index.html" class="nav-logo">
        <div class="nav-logo-icon">P</div>
        <span class="nav-logo-text">Property<span>Bazaar</span></span>
      </a>
      <div class="nav-links">
        <a href="index.html" class="nav-link">Home</a>
        <a href="properties.html?type=buy" class="nav-link active">Buy</a>
        <a href="properties.html?type=rent" class="nav-link">Rent</a>
        <a href="post-property.html" class="nav-link">Post Property</a>
        <a href="about.html" class="nav-link">About</a>
        <a href="contact.html" class="nav-link">Contact</a>
      </div>
      <div class="nav-actions">
        <a href="login.html" class="nav-btn-login">Login / Register</a>
        <a href="post-property.html" class="nav-btn-post">+ Post FREE Property</a>
      </div>
      <div class="hamburger" id="hamburger"><span></span><span></span><span></span></div>
    </nav>
  </div>
  <div class="mobile-menu" id="mobileMenu">
    <a href="index.html">ğŸ  Home</a>
    <a href="properties.html">ğŸ” Properties</a>
    <a href="post-property.html">â• Post Property</a>
  </div>
</header>

<!-- PAGE BREADCRUMB BAR -->
<div style="background:#fff;border-bottom:1px solid var(--border);padding:14px 0;margin-top:64px">
  <div class="container">
    <div class="page-breadcrumb" style="color:var(--text-muted)">
      <a href="index.html" style="color:var(--text-muted)">Home</a> â€º
      <a href="properties.html" style="color:var(--text-muted)">Properties</a> â€º
      <span style="color:var(--text)">3 BHK Apartment in Noida</span>
    </div>
  </div>
</div>

<!-- MAIN DETAIL LAYOUT -->
<div class="container">
  <div class="detail-layout">

    <!-- LEFT COLUMN -->
    <div>
      <!-- GALLERY -->
      <div class="detail-gallery" style="margin-top:24px">
        <div class="gallery-main gallery-skeleton">
          <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
               alt="Property Main View" id="mainGalleryImg" style="opacity:0;width:100%;height:100%;object-fit:cover">
        </div>
        <div class="gallery-thumb gallery-skeleton" id="galleryThumb2">
          <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
               alt="Property View 2" id="galleryImg2" style="opacity:0;cursor:pointer;width:100%;height:100%;object-fit:cover">
        </div>
        <div class="gallery-thumb gallery-skeleton" style="position:relative" id="galleryThumb3">
          <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"
               alt="Property View 3" id="galleryImg3" style="opacity:0;cursor:pointer;width:100%;height:100%;object-fit:cover">
          <div class="gallery-more" id="galleryMore" style="display:none"></div>
        </div>
      </div>

      <!-- TITLE CARD -->
      <div class="detail-card">
        <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:16px;flex-wrap:wrap">
          <div>
            <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px">
              <span class="badge badge-primary">BUY</span>
              <span class="badge badge-verified">âœ“ Verified</span>
              <span class="badge badge-success">âœ… Ready to Move</span>
              <span style="background:#EFF6FF;color:#3B82F6;padding:3px 10px;border-radius:6px;font-size:11px;font-weight:700">RERA: UP/2024/12345</span>
            </div>
            <div class="detail-price">â‚¹85 Lakh</div>
            <div style="font-size:13px;color:var(--text-muted);margin-top:2px">â‚¹5,862 per sq.ft Â· EMI starts at â‚¹54,000/mo</div>
            <h1 class="detail-title">Luxurious 3 BHK Flat in Premium Society</h1>
            <div class="detail-location">ğŸ“ <a href="#" style="color:var(--primary)">Sector 62</a>, Noida, Uttar Pradesh</div>
          </div>
          <div style="display:flex;gap:8px">
            <button style="width:40px;height:40px;border:1.5px solid var(--border);border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;font-size:20px;cursor:pointer;transition:var(--transition)" title="Save" onmouseover="this.style.borderColor='var(--primary)'" onmouseout="this.style.borderColor='var(--border)'">ğŸ¤</button>
            <button style="width:40px;height:40px;border:1.5px solid var(--border);border-radius:var(--radius-sm);display:flex;align-items:center;justify-content:center;font-size:18px;cursor:pointer" title="Share">ğŸ”—</button>
          </div>
        </div>

        <!-- SPEC CARDS -->
        <div class="detail-specs">
          <div class="detail-spec">
            <div class="detail-spec-icon">ğŸ›ï¸</div>
            <div class="detail-spec-value">3 BHK</div>
            <div class="detail-spec-label">Bedrooms</div>
          </div>
          <div class="detail-spec">
            <div class="detail-spec-icon">ğŸ“</div>
            <div class="detail-spec-value">1,450 sq.ft</div>
            <div class="detail-spec-label">Built-up Area</div>
          </div>
          <div class="detail-spec">
            <div class="detail-spec-icon">ğŸ§­</div>
            <div class="detail-spec-value">East</div>
            <div class="detail-spec-label">Facing</div>
          </div>
          <div class="detail-spec">
            <div class="detail-spec-icon">ğŸ¢</div>
            <div class="detail-spec-value">8th / 18</div>
            <div class="detail-spec-label">Floor</div>
          </div>
          <div class="detail-spec">
            <div class="detail-spec-icon">ğŸš—</div>
            <div class="detail-spec-value">1 Covered</div>
            <div class="detail-spec-label">Parking</div>
          </div>
          <div class="detail-spec">
            <div class="detail-spec-icon">ğŸ“…</div>
            <div class="detail-spec-value">Jan 2020</div>
            <div class="detail-spec-label">Built On</div>
          </div>
        </div>
      </div>

      <!-- DESCRIPTION -->
      <div class="detail-card">
        <h2 style="font-size:18px;font-weight:700;color:var(--dark);margin-bottom:14px">Property Description</h2>
        <p style="font-size:14px;color:var(--text-muted);line-height:1.8">A beautifully designed 3BHK apartment with modern amenities in a premium gated society in Sector 62, Noida. The apartment features large windows that bring in abundant natural light, a fully-modular kitchen with premium fittings, and stunning city views from the sprawling balcony.</p>
        <p style="font-size:14px;color:var(--text-muted);line-height:1.8;margin-top:10px">The society has world-class amenities including a swimming pool, well-equipped gymnasium, landscaped gardens, children's play area and 24x7 multi-layer security. Located minutes from Noida Sector 62 metro station, Logix City Centre Mall and major IT hubs.</p>
        <div style="margin-top:16px;display:flex;gap:8px;flex-wrap:wrap">
          <span style="background:var(--bg);padding:5px 12px;border-radius:20px;font-size:12px;color:var(--text-muted)">ğŸ—ï¸ DDA Approved</span>
          <span style="background:var(--bg);padding:5px 12px;border-radius:20px;font-size:12px;color:var(--text-muted)">ğŸ“‹ RERA Registered</span>
          <span style="background:var(--bg);padding:5px 12px;border-radius:20px;font-size:12px;color:var(--text-muted)">ğŸ”‘ Owner Listing</span>
          <span style="background:var(--bg);padding:5px 12px;border-radius:20px;font-size:12px;color:var(--text-muted)">ğŸš‡ Metro: 0.5 km</span>
          <span style="background:var(--bg);padding:5px 12px;border-radius:20px;font-size:12px;color:var(--text-muted)">ğŸ¥ Hospital: 1.2 km</span>
          <span style="background:var(--bg);padding:5px 12px;border-radius:20px;font-size:12px;color:var(--text-muted)">ğŸ« School: 0.8 km</span>
        </div>
      </div>

      <!-- AMENITIES -->
      <div class="detail-card">
        <h2 style="font-size:18px;font-weight:700;color:var(--dark);margin-bottom:16px">Amenities & Features</h2>
        <div class="amenities-grid">
          <div class="amenity-item"><div class="amenity-icon">ğŸŠ</div> Swimming Pool</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ’ª</div> Fully Equipped Gym</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ </div> Clubhouse</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ”’</div> 24x7 Security</div>
          <div class="amenity-item"><div class="amenity-icon">âš¡</div> Power Backup</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ›—</div> High-Speed Lifts</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸŒ³</div> Landscaped Garden</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸš—</div> Covered Parking</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ®</div> Children Play Area</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ”¥</div> Fire Safety</div>
          <div class="amenity-item"><div class="amenity-icon">ğŸ“¡</div> Intercom</div>
          <div class="amenity-item"><div class="amenity-icon">â™»ï¸</div> Waste Management</div>
        </div>
      </div>

      <!-- EMI CALCULATOR -->
      <div class="detail-card">
        <h2 style="font-size:18px;font-weight:700;color:var(--dark);margin-bottom:16px">ğŸ§® EMI Calculator</h2>
        <div class="emi-inputs">
          <div class="emi-field">
            <div class="emi-field-val" style="margin-bottom:6px">
              <label style="font-size:12px;font-weight:600;color:var(--text-muted)">Loan Amount</label>
              <span id="emi-loan-val" style="font-size:13px;font-weight:700;color:var(--dark)">â‚¹68L</span>
            </div>
            <input type="range" id="emi-loan" min="500000" max="50000000" step="500000" value="6800000">
          </div>
          <div class="emi-field">
            <div class="emi-field-val" style="margin-bottom:6px">
              <label style="font-size:12px;font-weight:600;color:var(--text-muted)">Interest Rate (per annum)</label>
              <span id="emi-rate-val" style="font-size:13px;font-weight:700;color:var(--dark)">8.5%</span>
            </div>
            <input type="range" id="emi-rate" min="6" max="15" step="0.1" value="8.5">
          </div>
          <div class="emi-field">
            <div class="emi-field-val" style="margin-bottom:6px">
              <label style="font-size:12px;font-weight:600;color:var(--text-muted)">Loan Tenure</label>
              <span id="emi-tenure-val" style="font-size:13px;font-weight:700;color:var(--dark)">20 yrs</span>
            </div>
            <input type="range" id="emi-tenure" min="5" max="30" step="1" value="20">
          </div>
        </div>
        <div class="emi-result">
          <div class="emi-amount" id="emi-result">â‚¹--</div>
          <div class="emi-label">Estimated Monthly EMI</div>
        </div>
        <p style="font-size:11px;color:var(--text-muted);margin-top:10px;text-align:center">*Approximate value. Actual EMI may vary based on bank policies.</p>
      </div>

      <!-- LOCATION -->
      <div class="detail-card">
        <h2 style="font-size:18px;font-weight:700;color:var(--dark);margin-bottom:14px">ğŸ“ Location Map</h2>
        <div style="background:var(--bg);border-radius:var(--radius-sm);height:260px;display:flex;align-items:center;justify-content:center;border:2px dashed var(--border);flex-direction:column;gap:10px">
          <div style="font-size:40px">ğŸ—ºï¸</div>
          <p style="font-size:14px;color:var(--text-muted)">Sector 62, Noida, Uttar Pradesh 201301</p>
          <a href="https://maps.google.com?q=Sector+62+Noida" target="_blank" class="btn btn-outline btn-sm">Open in Google Maps â†—</a>
        </div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:14px">
          <div style="background:var(--bg);padding:10px;border-radius:var(--radius-sm);text-align:center;font-size:12px">
            <div style="font-size:20px;margin-bottom:4px">ğŸš‡</div>
            <div style="font-weight:600;color:var(--text)">Metro</div>
            <div style="color:var(--text-muted)">0.5 km</div>
          </div>
          <div style="background:var(--bg);padding:10px;border-radius:var(--radius-sm);text-align:center;font-size:12px">
            <div style="font-size:20px;margin-bottom:4px">ğŸ«</div>
            <div style="font-weight:600;color:var(--text)">School</div>
            <div style="color:var(--text-muted)">0.8 km</div>
          </div>
          <div style="background:var(--bg);padding:10px;border-radius:var(--radius-sm);text-align:center;font-size:12px">
            <div style="font-size:20px;margin-bottom:4px">ğŸ›’</div>
            <div style="font-weight:600;color:var(--text)">Mall</div>
            <div style="color:var(--text-muted)">1.5 km</div>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT COLUMN â€” CONTACT CARD -->
    <div style="margin-top:24px">
      <div class="contact-card">
        <h3>Contact Owner / Agent</h3>
        <p>Get more details about this property for FREE</p>
        <div class="contact-form-group">
          <label>Your Name</label>
          <input type="text" id="contactName" placeholder="Enter your full name">
        </div>
        <div class="contact-form-group">
          <label>Mobile Number</label>
          <input type="tel" id="contactPhone" placeholder="+91 XXXXX XXXXX">
        </div>
        <div class="contact-form-group">
          <label>Email (Optional)</label>
          <input type="email" id="contactEmail" placeholder="your@email.com">
        </div>
        <div class="contact-form-group">
          <label>Message</label>
          <textarea id="contactMessage" rows="3" placeholder="Hi, I am interested in this property. Please contact me.">Hi, I am interested in this property. Please contact me.</textarea>
        </div>
        <div class="contact-btns">
          <button class="contact-btn contact-btn-call">ğŸ“ Call Now</button>
          <button class="contact-btn contact-btn-wa">ğŸ’¬ WhatsApp</button>
          <button class="contact-btn contact-btn-email" id="btnSendEnquiry">âœ‰ï¸ Send Enquiry</button>
        </div>
        <div id="contactSuccess" style="display:none; color:#10b981; font-weight:bold; margin-top:14px; text-align:center; padding:10px; background:rgba(16,185,129,0.1); border-radius:8px;">
          âœ… Enquiry Sent Successfully!
        </div>
        <div id="contactLoader" class="loader" style="display:none; margin: 10px auto;"></div>
        <p style="font-size:11px;color:var(--text-muted);text-align:center;margin-top:14px">By submitting, you agree to our <a href="#" style="color:var(--primary)">Terms</a> & <a href="#" style="color:var(--primary)">Privacy Policy</a></p>
      </div>

      <!-- SELLER CARD -->
      <div class="detail-card" style="margin-top:16px">
        <h3 style="font-size:15px;font-weight:700;color:var(--dark);margin-bottom:14px">Listed By</h3>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:14px">
          <div style="width:48px;height:48px;background:linear-gradient(135deg,var(--primary),var(--primary-light));border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:20px;font-weight:700">R</div>
          <div>
            <div style="font-weight:700;font-size:15px;color:var(--dark)">Rajesh Kumar</div>
            <div style="font-size:12px;color:var(--text-muted)">ğŸ  Owner Â· Member since 2019</div>
            <div style="font-size:12px;color:var(--success)">âœ… ID Verified</div>
          </div>
        </div>
        <div style="background:var(--bg);border-radius:var(--radius-sm);padding:12px;font-size:13px;color:var(--text-muted);line-height:1.6">
          ğŸ”’ Phone number visible after contacting
        </div>
      </div>

      <!-- KEY HIGHLIGHTS -->
      <div class="detail-card" style="margin-top:16px">
        <h3 style="font-size:15px;font-weight:700;color:var(--dark);margin-bottom:14px">Key Highlights</h3>
        <div style="display:flex;flex-direction:column;gap:10px">
          <div style="display:flex;align-items:center;gap:10px;font-size:13px">
            <span style="width:28px;height:28px;background:rgba(16,185,129,0.1);border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0">âœ…</span>
            <span style="color:var(--text)">RERA Registered Project</span>
          </div>
          <div style="display:flex;align-items:center;gap:10px;font-size:13px">
            <span style="width:28px;height:28px;background:rgba(59,130,246,0.1);border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0">ğŸ”</span>
            <span style="color:var(--text)">Physically Verified Listing</span>
          </div>
          <div style="display:flex;align-items:center;gap:10px;font-size:13px">
            <span style="width:28px;height:28px;background:rgba(245,158,11,0.1);border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0">ğŸ¤</span>
            <span style="color:var(--text)">Zero Brokerage (Direct Owner)</span>
          </div>
          <div style="display:flex;align-items:center;gap:10px;font-size:13px">
            <span style="width:28px;height:28px;background:rgba(139,92,246,0.1);border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0">ğŸ“¹</span>
            <span style="color:var(--text)">Video Tour Available</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SIMILAR PROPERTIES -->
<section class="section" style="background:var(--bg)">
  <div class="container">
    <div class="section-header" style="text-align:left;margin-bottom:24px">
      <h2 style="font-size:22px">Similar Properties You May Like</h2>
    </div>
    <div class="cards-slider-wrap">
      <div class="cards-slider">
        <div class="property-card" style="min-width:280px;flex-shrink:0">
          <div class="prop-img-wrap"><img src="images/city-mumbai.jpg" alt="Similar Property"><div class="prop-type-badge"><span class="badge badge-primary">BUY</span></div><div class="prop-wishlist">ğŸ¤</div></div>
          <div class="prop-body">
            <div class="prop-price">â‚¹72 Lakh</div>
            <div class="prop-title">3 BHK Apartment in Sector 61</div>
            <div class="prop-location">ğŸ“ Noida</div>
            <div class="prop-specs"><div class="prop-spec">ğŸ›ï¸ 3 BHK</div><div class="prop-spec">ğŸ“ 1,350 sq.ft</div></div>
          </div>
        </div>
        <div class="property-card" style="min-width:280px;flex-shrink:0">
          <div class="prop-img-wrap"><img src="images/hero-bg.jpg" alt="Similar Property"><div class="prop-type-badge"><span class="badge badge-primary">BUY</span></div><div class="prop-verified">âœ“ Verified</div><div class="prop-wishlist">ğŸ¤</div></div>
          <div class="prop-body">
            <div class="prop-price">â‚¹98 Lakh</div>
            <div class="prop-title">3 BHK Semi-Furnished Flat</div>
            <div class="prop-location">ğŸ“ Sector 63, Noida</div>
            <div class="prop-specs"><div class="prop-spec">ğŸ›ï¸ 3 BHK</div><div class="prop-spec">ğŸ“ 1,550 sq.ft</div></div>
          </div>
        </div>
        <div class="property-card" style="min-width:280px;flex-shrink:0">
          <div class="prop-img-wrap"><img src="images/property-1.jpg" alt="Similar Property"><div class="prop-type-badge"><span class="badge badge-primary">BUY</span></div><div class="prop-wishlist">ğŸ¤</div></div>
          <div class="prop-body">
            <div class="prop-price">â‚¹1.1 Cr</div>
            <div class="prop-title">4 BHK Premium Flat</div>
            <div class="prop-location">ğŸ“ Sector 60, Noida</div>
            <div class="prop-specs"><div class="prop-spec">ğŸ›ï¸ 4 BHK</div><div class="prop-spec">ğŸ“ 1,900 sq.ft</div></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer class="footer">
  <div class="container">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="footer-logo"><div class="nav-logo-icon">P</div> PropertyBazaar</div>
        <p class="footer-tagline">India's most trusted real estate portal.</p>
        <div class="footer-socials"><a href="#" class="social-icon">ğŸ“˜</a><a href="#" class="social-icon">ğŸ“¸</a><a href="#" class="social-icon">ğŸ¦</a></div>
      </div>
      <div class="footer-col"><h4>Quick Links</h4><div class="footer-links"><a href="properties.html?type=buy">Buy</a><a href="properties.html?type=rent">Rent</a><a href="post-property.html">Post Property</a><a href="about.html">About</a><a href="contact.html">Contact</a></div></div>
      <div class="footer-col"><h4>Top Cities</h4><div class="footer-links"><a href="#">Mumbai</a><a href="#">Delhi NCR</a><a href="#">Bangalore</a><a href="#">Hyderabad</a><a href="#">Pune</a></div></div>
      <div class="footer-col"><h4>Resources</h4><div class="footer-links"><a href="#">EMI Calculator</a><a href="#">Home Loan</a><a href="#">RERA Guide</a><a href="#">Blog</a></div></div>
    </div>
    <div class="footer-bottom"><span>Â© 2025 PropertyBazaar. All rights reserved.</span><div class="footer-bottom-links"><a href="#">Privacy</a><a href="#">Terms</a></div></div>
  </div>
</footer>

<script src="js/properties.js"></script>
<script src="js/main.js"></script>
<script type="module">
  import { convex } from './js/convex.js';

  (async () => {
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    if (!id) return; // no ID = show default hardcoded page

    try {
      const p = await convex.query('properties:getProperty', { id });
      if (!p) return;

    // ---- Resolve photo URLs ----
    const resolvedPhotos = await Promise.all(
      (p.photos || []).map(async (sid) => {
        try {
          const url = await convex.query('properties:getPhotoUrl', { storageId: sid });
          return url || sid;
        } catch { return sid; }
      })
    );
    // fallback
    const photos = resolvedPhotos.filter(Boolean);
    if (photos.length === 0) photos.push('images/property-1.jpg');

    // ---- Helpers ----
    const isLand = /plot|land/i.test(p.propertyType || '');
    const isCommercial = /commercial|shop|office|warehouse/i.test(p.propertyType || '');
    const bhk = p.details?.bhk;
    const price = p.pricing?.expectedPrice || 0;
    const area = p.details?.builtUpArea || 0;
    const priceStr = 'â‚¹' + price.toLocaleString('en-IN');
    const ppsf = area > 0 ? Math.round(price / area) : 0;

    // Title
    let title = p.propertyType;
    if (!isLand && !isCommercial && bhk && bhk !== '0') title = `${bhk} BHK ${p.propertyType}`;

    // ---- Update page title / breadcrumb ----
    document.title = `${title} in ${p.location?.locality || p.location?.city} | PropertyBazaar`;
    document.querySelector('.page-breadcrumb span')?.textContent && (
      document.querySelector('.page-breadcrumb span').textContent = title
    );

    // Gallery element refs
    const mainImg = document.getElementById('mainGalleryImg');
    const galleryImg2 = document.getElementById('galleryImg2');
    const galleryImg3 = document.getElementById('galleryImg3');
    const galleryThumb2 = document.getElementById('galleryThumb2');
    const galleryThumb3 = document.getElementById('galleryThumb3');
    const galleryMore = document.getElementById('galleryMore');

    // ---- Lightbox setup ----

    const lb = document.getElementById('photolightbox');
    const lbImg = document.getElementById('lbMainImg');
    const lbCounter = document.getElementById('lbCounter');
    const lbThumbs = document.getElementById('lbThumbs');
    let lbIndex = 0;

    function lbOpen(idx) {
      lbIndex = Math.max(0, Math.min(idx, photos.length - 1));
      lbImg.src = photos[lbIndex];
      lbCounter.textContent = `${lbIndex + 1} / ${photos.length}`;
      lbThumbs.querySelectorAll('.lb-thumb').forEach((t, i) => t.classList.toggle('active', i === lbIndex));
      lb.classList.add('open');
      document.body.style.overflow = 'hidden';
    }
    function lbClose() {
      lb.classList.remove('open');
      document.body.style.overflow = '';
    }
    function lbGo(delta) {
      lbOpen((lbIndex + delta + photos.length) % photos.length);
    }

    // Build thumbnail strip
    lbThumbs.innerHTML = photos.map((src, i) =>
      `<img class="lb-thumb ${i===0?'active':''}" src="${src}" data-idx="${i}" alt="Photo ${i+1}">`
    ).join('');
    lbThumbs.querySelectorAll('.lb-thumb').forEach(t => {
      t.addEventListener('click', e => { e.stopPropagation(); lbOpen(parseInt(t.dataset.idx)); });
    });

    document.getElementById('lbClose').addEventListener('click', lbClose);
    document.getElementById('lbPrev').addEventListener('click', e => { e.stopPropagation(); lbGo(-1); });
    document.getElementById('lbNext').addEventListener('click', e => { e.stopPropagation(); lbGo(1); });
    lb.addEventListener('click', lbClose); // click backdrop to close
    lbImg.addEventListener('click', e => e.stopPropagation());
    document.addEventListener('keydown', e => {
      if (!lb.classList.contains('open')) return;
      if (e.key === 'ArrowLeft') lbGo(-1);
      if (e.key === 'ArrowRight') lbGo(1);
      if (e.key === 'Escape') lbClose();
    });
    // Touch swipe
    let touchStartX = 0;
    lb.addEventListener('touchstart', e => { touchStartX = e.touches[0].clientX; }, { passive: true });
    lb.addEventListener('touchend', e => {
      const dx = e.changedTouches[0].clientX - touchStartX;
      if (Math.abs(dx) > 50) lbGo(dx < 0 ? 1 : -1);
    });

    // ---- Load gallery thumbnails ----
    function loadImg(imgEl, wrapEl, src, photoIdx) {
      if (!imgEl) return;
      const tmp = new Image();
      tmp.onload = () => {
        imgEl.src = src;
        imgEl.style.opacity = '1';
        if (wrapEl) wrapEl.classList.remove('gallery-skeleton');
      };
      tmp.src = src;
      imgEl.style.cursor = 'zoom-in';
      imgEl.addEventListener('click', () => lbOpen(photoIdx));
    }

    // Wire gallery images
    if (mainImg) {
      mainImg.style.cursor = 'zoom-in';
      mainImg.addEventListener('click', () => lbOpen(0));
      const tmp = new Image();
      tmp.onload = () => { mainImg.src = photos[0]; mainImg.style.opacity = '1'; mainImg.parentElement?.classList.remove('gallery-skeleton'); };
      tmp.src = photos[0];
    }
    if (photos[1]) loadImg(galleryImg2, galleryThumb2, photos[1], 1);
    else if (galleryThumb2) galleryThumb2.style.display = 'none';

    if (photos[2]) loadImg(galleryImg3, galleryThumb3, photos[2], 2);
    else if (galleryThumb3) galleryThumb3.style.display = 'none';

    // "+N Photos" badge â€” dynamic count
    if (galleryMore) {
      const extra = photos.length - 3;
      if (extra > 0) {
        galleryMore.textContent = `+${extra} Photos`;
        galleryMore.style.display = '';
        galleryMore.style.cursor = 'pointer';
        galleryMore.addEventListener('click', () => lbOpen(3));
      } else {
        galleryMore.style.display = 'none';
      }
    }
    // Also make gallery-more on thumb3's parent open lightbox
    if (galleryThumb3) galleryThumb3.addEventListener('click', () => lbOpen(2));


    // ---- Price & Title card ----
    document.querySelector('.detail-price')?.textContent && (
      document.querySelector('.detail-price').textContent = priceStr
    );
    const priceSub = document.querySelector('.detail-price + div');
    if (priceSub) priceSub.textContent = ppsf > 0 ? `â‚¹${ppsf.toLocaleString('en-IN')} per sq.ft` : '';
    const detailTitle = document.querySelector('.detail-title');
    if (detailTitle) detailTitle.textContent = `${title} in ${p.location?.society || p.location?.locality || ''}`;
    const detailLoc = document.querySelector('.detail-location');
    if (detailLoc) detailLoc.innerHTML = `ğŸ“ ${p.location?.locality || ''}, ${p.location?.city || ''}, ${p.location?.state || ''}`;

    // ---- Specs ----
    const specsEl = document.querySelector('.detail-specs');
    if (specsEl) {
      const specs = [];
      if (!isLand && !isCommercial && bhk && bhk !== '0') {
        specs.push({ icon: 'ğŸ›ï¸', val: `${bhk} BHK`, label: 'Bedrooms' });
      }
      if (area > 0) specs.push({ icon: 'ğŸ“', val: `${area.toLocaleString('en-IN')} sq.ft`, label: 'Built-up Area' });
      if (p.details?.carpetArea) specs.push({ icon: 'ğŸ“', val: `${p.details.carpetArea} sq.ft`, label: 'Carpet Area' });
      if (p.details?.facing) specs.push({ icon: 'ğŸ§­', val: p.details.facing, label: 'Facing' });
      if (!isLand && p.details?.floorNumber) {
        specs.push({ icon: 'ğŸ¢', val: `${p.details.floorNumber}${p.details.totalFloors ? ' / ' + p.details.totalFloors : ''}`, label: 'Floor' });
      }
      if (!isLand && p.details?.furnishing) specs.push({ icon: 'ğŸ›‹ï¸', val: p.details.furnishing, label: 'Furnishing' });
      if (p.details?.parking && p.details.parking !== 'None') specs.push({ icon: 'ğŸš—', val: p.details.parking, label: 'Parking' });
      if (p.details?.constructionYear) specs.push({ icon: 'ğŸ“…', val: p.details.constructionYear, label: 'Built Year' });

      specsEl.innerHTML = specs.map(s => `
        <div class="detail-spec">
          <div class="detail-spec-icon">${s.icon}</div>
          <div class="detail-spec-value">${s.val}</div>
          <div class="detail-spec-label">${s.label}</div>
        </div>`).join('');
    }

    // ---- Description ----
    const descEl = document.querySelector('.detail-card p');
    if (descEl && p.details?.description) descEl.textContent = p.details.description;
    // Second para
    const descCards = document.querySelectorAll('.detail-card');
    const descCard = Array.from(descCards).find(el => el.querySelector('h2')?.textContent.includes('Description'));
    if (descCard) {
      const extra = descCard.querySelector('p:nth-of-type(2)');
      if (extra) extra.remove();
    }

    // ---- Amenities ----
    const amenGrid = document.querySelector('.amenities-grid');
    if (amenGrid && p.amenities?.length > 0) {
      const icons = { 'Swimming Pool': 'ğŸŠ', 'Gym': 'ğŸ’ª', 'Clubhouse': 'ğŸ ', 'Security': 'ğŸ”’',
        'Power Backup': 'âš¡', 'Lift': 'ğŸ›—', 'Garden': 'ğŸŒ³', 'Parking': 'ğŸš—',
        'Play Area': 'ğŸ®', 'Fire Safety': 'ğŸ”¥', 'Intercom': 'ğŸ“¡', 'CCTV': 'ğŸ“¹',
        'WiFi': 'ğŸ“¶', 'Gas Pipeline': 'ğŸ”¥', 'Solar': 'â˜€ï¸' };
      amenGrid.innerHTML = p.amenities.map(a => {
        const icon = Object.entries(icons).find(([k]) => a.toLowerCase().includes(k.toLowerCase()))?.[1] || 'âœ…';
        return `<div class="amenity-item"><div class="amenity-icon">${icon}</div> ${a}</div>`;
      }).join('');
    } else if (amenGrid && (!p.amenities || p.amenities.length === 0)) {
      amenGrid.closest('.detail-card')?.remove(); // hide empty amenities section
    }

    // ---- Contact card ----
    if (p.contactDesc) {
      const ct = p.contactDesc;
      const sellerDiv = document.querySelector('.detail-card h3')?.closest('.detail-card');
      // Update seller info
      const sellerCard = document.querySelectorAll('.detail-card');
      sellerCard.forEach(card => {
        if (card.querySelector('h3')?.textContent.includes('Listed By')) {
          const nameEl = card.querySelector('div[style*="font-weight:700"]') || card.querySelector('.font-bold');
          const initial = document.querySelector('.detail-card div[style*="border-radius:50%"]');
          if (initial) initial.textContent = (ct.name || 'U')[0].toUpperCase();
          const rows = card.querySelectorAll('div[style*="font-weight:700"]');
          if (rows[0]) rows[0].textContent = ct.name || 'Owner';
          const roleEl = card.querySelector('div[style*="font-size:12px"]');
          if (roleEl) roleEl.textContent = `ğŸ  ${ct.role || 'Owner'} Â· Listed on PropertyBazaar`;
        }
      });

      // Update Call/WhatsApp buttons
      const callBtn = document.querySelector('.contact-btn-call');
      const waBtn = document.querySelector('.contact-btn-wa');
      if (callBtn && ct.mobile) callBtn.onclick = () => window.location.href = `tel:${ct.mobile}`;
      if (waBtn && ct.mobile) waBtn.onclick = () => window.open(`https://wa.me/91${ct.mobile}`, '_blank');
    }

    // ---- Google Maps link ----
    const mapsLink = document.querySelector('a[href*="maps.google.com"]');
    if (mapsLink) {
      const addr = encodeURIComponent(`${p.location?.locality || ''} ${p.location?.city || ''} ${p.location?.state || ''} ${p.location?.pinCode || ''}`);
      mapsLink.href = `https://maps.google.com?q=${addr}`;
    }
    const mapText = document.querySelector('[href*="maps.google.com"]')?.previousElementSibling;
    if (mapText) mapText.textContent = `${p.location?.locality || ''}, ${p.location?.city || ''} ${p.location?.pinCode || ''}`;

    // ---- Handle Contact Owner Form ----
    const btnSendEnquiry = document.getElementById('btnSendEnquiry');
    if (btnSendEnquiry) {
      btnSendEnquiry.onclick = async () => {
        const name = document.getElementById('contactName')?.value;
        const phone = document.getElementById('contactPhone')?.value;
        const email = document.getElementById('contactEmail')?.value;
        const message = document.getElementById('contactMessage')?.value;
        const successMsg = document.getElementById('contactSuccess');
        const loader = document.getElementById('contactLoader');

        if (!name || !phone) {
          alert('Name and Mobile Number are required.');
          return;
        }

        btnSendEnquiry.style.display = 'none';
        if (loader) loader.style.display = 'block';

        try {
          await convex.mutation('properties:contactOwner', {
            propertyId: id,
            name, phone, email: email || '', message: message || ''
          });
          if (loader) loader.style.display = 'none';
          if (successMsg) successMsg.style.display = 'block';
          
          // Clear inputs
          document.getElementById('contactName').value = '';
          document.getElementById('contactPhone').value = '';
          document.getElementById('contactEmail').value = '';
          document.getElementById('contactMessage').value = '';

          // Hide success message after 5 seconds to allow sending another
          setTimeout(() => {
            if (successMsg) successMsg.style.display = 'none';
            btnSendEnquiry.style.display = 'inline-block';
          }, 5000);

        } catch (err) {
          alert('Failed to send enquiry: '+err.message);
          btnSendEnquiry.style.display = 'inline-block';
          if (loader) loader.style.display = 'none';
        }
      };
    }

    // ---- EMI seed value ----
    const emiLoan = document.getElementById('emi-loan');
    if (emiLoan && price > 0) {
      emiLoan.value = Math.round(price * 0.8); // 80% as loan
      emiLoan.dispatchEvent(new Event('input'));
    }

  } catch(err) {
    console.error('Failed to load property details:', err);
  }
  })();
</script>
</body>
</html>
